{% extends 'home/basic.html' %} 
{% block title %}Movie Description{% endblock title %} 
{% block css %} {% load static %}
<link rel="stylesheet" href="{% static 'home/css/moviedes.css' %}" />
{% endblock css %} {% block body %} {% load static %}

<div class="wrapper">
<div class="container movie-details" style="border-radius: 20px">
  <div class="row">
    <div class="col-md-6 left-box">
      <h1 style="font-weight: 700">{{movie.title}}</h1>
      <p>Genre: {{movie.genre}}</p>
      <p>Cast: </p>
      <style>
        .indent {
            padding-left: 50px;
        }
    </style>
      {%for i in movie_cast%}
        <p class="indent">{{ i.name }} as {{i.character}}</p>
      {%endfor%}
      <p>Director: {{ movie.crew|slice:"-1" }}</p>
      <p>IMDb Score: {{movie.imdbscore}}</p>
      <p>Runtime: {{movie.runtime}} minutes</p>
      <p>IMDb Link: <a href="https://www.imdb.com/title/{{movie.imdbid}}" target="_blank" style="text-decoration: none">{{movie.title}}</a></p>
    </div>
    
    <div class="col-md-6 text-center">
      <img src="{{movie.poster}}" class="movie-img" onerror="this.src='https://source.unsplash.com/400x600/?movie,{{movie.title}}';" width="250"/>
    </div>
  </div>
</div>
</div>

<div class="container similar">
  <h3>Similar Movies</h3>
  <div id="carouselExample" class="carousel carousel-dark slide" data-bs-ride="carousel">
    <div class="carousel-inner">
      <div class="carousel-item active">
        <div class="card-wrapper">
          {% for i in ritem %}
            <div class="card">
              <a style="text-decoration:none" href="/home/moviedes">
                <img src="{{i.poster}}" class="card-img-top" alt="Image has failed to load." onerror="this.src='https://source.unsplash.com/400x600/?movie,{{i.title}}';" height="350px">
                <div class="card-body">
                <h5 class="card-title">{{i.title}}</h5>
                <p class="card-text">Genre: {{i.genre}}<br>Score: {{i.imdbscore}}<br>Release Date: {{i.date}}</p>
              </a>	
                <form id= "alwat_recom{{i.pk}}" action="alwat/" method="POST">
                  {% csrf_token %}
                  {% comment %} <input type="hidden" name="amovieId" value="{{i.pk}}" />
                  <input type="submit" class="btn btn-outline-primary" value="Already Watched"> {% endcomment %}
                  <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#exampleModalrecom{{forloop.counter}}">
                    Already Watched
                  </button>
                  <div class="modal fade" id="exampleModalrecom{{forloop.counter}}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                      <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Please rate the movie:</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                        <label for="rating{{i.pk}}" class="form-label">Rating 1-10</label>
                        <input type="hidden" name="amovieId" id="amovieId{{i.pk}}" value="{{i.pk}}" />
                        <input type="range" value="1" class="form-range" min="1" max="10" id="rating{{i.pk}}" name="rating" oninput="this.nextElementSibling.value = this.value">
                        <output>1</output>
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <input type="submit" class="btn btn-outline-primary" data-bs-dismiss="modal" value="Submit">
                      </div>
                      </div>
                    </div>
                    </div>
                </form>
              <form id="p2w_recom{{i.pk}}" method="POST" action="p2w/">
                  {% csrf_token %}
                <input type="hidden" name="movieId" id="movieId{{i.pk}}" value="{{i.pk}}" />
                <input type="submit" class="btn btn-outline-primary" value="Plan-to-Watch">
              </form>
              
            </div>
            </div>
          {% if forloop.counter|divisibleby:5 and forloop.counter > 0 and not forloop.last %}
          </div>
          </div>
          <div class="carousel-item">
            <div class="cards-wrapper">
          {% endif %}
          {% endfor %}
        </div>
      </div>

      {% endblock body %}
    </div>
  </div>
</div>
